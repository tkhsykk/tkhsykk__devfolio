/**
 * スライダーコンポーネント
 *
 * 概要:
 * 画像スライダーコンポーネントのスタイル定義
 *
 * 主な仕様:
 * - 横スクロール型のスライダー
 * - 前へ/次へボタンによる操作
 * - ページネーション表示
 * - レスポンシブ対応
 *
 * 制限事項:
 * - スライドは横方向のみ対応
 */

@use '../foundation' as *;

.c-slider {
	position: relative;
	width: 100%;
	margin-bottom: $spacing-4;

	&__viewport {
		position: relative;
		width: 100%;
		overflow: hidden;
		border-radius: $border-radius-sm;
	}

	&__track {
		display: flex;
		transition: transform 0.3s ease-in-out;
		will-change: transform;
	}

	&__slide {
		flex: 0 0 100%;
		width: 100%;
		position: relative;

		a {
			display: block;
			position: relative;
			cursor: zoom-in;
			overflow: hidden;
			transition: all $transition-base;

			// スマホ用: 右下に虫眼鏡アイコンを常時表示
			&::before {
				content: '';
				position: absolute;
				bottom: $spacing-2;
				right: $spacing-2;
				width: 32px;
				height: 32px;
				background-color: rgba($color-black, 0.6);
				background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='11' cy='11' r='8'%3E%3C/circle%3E%3Cline x1='21' y1='21' x2='16.65' y2='16.65'%3E%3C/line%3E%3C/svg%3E");
				background-repeat: no-repeat;
				background-position: center;
				background-size: 18px;
				border-radius: 50%;
				pointer-events: none;
				z-index: 2;
				opacity: 1;

				// PC (md以上) では非表示
				@include mq(md) {
					display: none;
				}
			}

			// PC用: ホバー時に画面全体にオーバーレイ表示
			&::after {
				content: '';
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background-color: rgba($color-black, 0.3);
				background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='11' cy='11' r='8'%3E%3C/circle%3E%3Cline x1='21' y1='21' x2='16.65' y2='16.65'%3E%3C/line%3E%3C/svg%3E");
				background-repeat: no-repeat;
				background-position: center;
				background-size: 40px;
				opacity: 0;
				transition: opacity $transition-base;
				pointer-events: none;
				z-index: 1;
				// スマホでは ::after オーバーレイを非表示
				display: none;

				// PC (md以上) で有効化
				@include mq(md) {
					display: block;
				}
			}

			&:hover,
			&:focus-visible {
				&::after {
					opacity: 1;
				}

				img {
					transform: scale(1.05);
				}
				}

			// キーボード操作時のフォーカスリング
			&:focus-visible {
				outline: 2px solid $color-primary;
				outline-offset: -2px;
			}
		}

		img {
			aspect-ratio: 4/3;
			width: 100%;
			height: auto;
			display: block;
			object-fit: cover;
			transition: transform 0.5s ease;
			will-change: transform;
		}
	}

	&__button {
		position: absolute;
		top: 50%;
		transform: translateY(-50%);
		z-index: 2;
		width: 36px;
		height: 36px;
		display: flex;
		align-items: center;
		justify-content: center;
		cursor: pointer;
		padding: 0;
		border: 1px solid rgba($color-white, 0.3);
		border-radius: 50%;
		background-color: rgba($color-white, 0.7);
		backdrop-filter: blur(8px);
		box-shadow: 0 4px 12px rgba($color-black, 0.1);
		transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
		color: $color-text;
		opacity: 0; // 初期状態は非表示（ホバーで表示させるなどの演出も可能だが、今回は常時表示でアクセシビリティ確保しつつ、スライドエリアホバーで強調など）

		// 常時表示に戻す（UX考慮）
		opacity: 1;

		@include mq(md) {
			background-color: rgba($color-white, 0.1);
			width: 56px;
			height: 56px;
		}

		&:hover,
		&:focus-visible {
			background-color: rgba($color-white, 0.9);
			border-color: transparent;
			box-shadow: 0 8px 24px rgba($color-black, 0.15);
			transform: translateY(-50%) scale(1.1);
			color: $color-black;

			svg {
				stroke-width: 2.5;
			}
		}

		&:focus-visible {
			outline: 2px solid $color-primary;
			outline-offset: 2px;
		}

		&:active {
			transform: translateY(-50%) scale(0.95);
			transition-duration: 0.1s;
		}

		&:disabled {
			opacity: 0.3;
			cursor: not-allowed;
			pointer-events: none;
		}

		svg {
			width: 24px;
			height: 24px;
			stroke: currentColor;
			transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1),
			stroke-width 0.3s ease;
			pointer-events: none;
		}

		&--prev {
			left: -20px;

			@include mq(md) {
				left: $spacing-4;
			}

			&:hover,
			&:focus-visible {
				svg {
					transform: translateX(-4px);
				}
			}
		}

		&--next {
			right: -20px;

			@include mq(md) {
				right: $spacing-4;
			}

			&:hover,
			&:focus-visible {
				svg {
					transform: translateX(4px);
				}
			}
		}

		@include mq(sm) {
			width: 36px;
			height: 36px;
			background-color: rgba($color-white, 0.8);
			backdrop-filter: blur(4px);

			&--prev {
				left: $spacing-2;
			}

			&--next {
				right: $spacing-2;
			}

			svg {
				width: 16px;
				height: 16px;
			}
		}
	}

	&__pagination {
		display: flex;
		justify-content: center;
		align-items: center;
		gap: $spacing-2;
		margin-top: $spacing-4;
		flex-wrap: wrap;
	}

	&__pagination-button {
		width: 8px;
		height: 8px;
		border-radius: 50%;
		background-color: rgba($color-white, 0.3);
		padding: 0;
		transition: background-color $transition-base, transform $transition-base;

		&:hover,
		&:focus-visible {
			background-color: rgba($color-white, 0.5);
			outline: 2px solid $color-primary;
			outline-offset: 2px;
			transform: scale(1.2);
		}

		&.is-active {
			background-color: $color-primary;
			transform: scale(1.2);
		}

		&:active {
			transform: scale(1.1);
		}
	}
}

