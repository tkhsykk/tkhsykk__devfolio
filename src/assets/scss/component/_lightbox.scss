/**
 * ライトボックスコンポーネント
 *
 * 概要:
 * 画像を原寸大で拡大表示するライトボックス
 * cloneNode + transform による tween アニメーション対応
 *
 * 主な仕様:
 * - 画像クリック時に原寸大で表示
 * - オーバーレイクリックまたはESCキーで閉じる
 * - cloneNode による tween アニメーション
 * - フェードイン/アウトアニメーション
 * - レスポンシブ対応
 *
 * 制限事項:
 * - 画像のみ対応（動画などは未対応）
 */

@use '../foundation' as *;

.c-lightbox {
	position: fixed;
	inset: 0;
	z-index: 1000;
	//opacity: 0;
	visibility: hidden;
	pointer-events: none;
	transition: opacity $transition-base, visibility $transition-base;

	// 開いている途中（clone アニメーション中）
	&.is-opening {
		//opacity: 0;
		visibility: visible;
		pointer-events: none;
	}

	// 開いている（clone アニメーション完了後）
	&.is-open {
		//opacity: 1;
		visibility: visible;
		pointer-events: auto;
	}

	// 閉じている途中（clone アニメーション中）
	&.is-closing {
		opacity: 0;
		visibility: visible;
		pointer-events: none;
	}

	// hidden 属性が設定されている場合は完全に非表示
	&[hidden] {
		display: none;
	}

	&__backdrop {
		position: fixed;
		inset: 0;
		background-color: rgba($color-black, 0.6);
		backdrop-filter: none;
		cursor: pointer;
		opacity: 1;
		transition: backdrop-filter $transition-base;
		z-index: 1000;
		z-index: 98;

		// .is-open & {
		// 	backdrop-filter: blur(6px);
		// }
	}

	&__dialog {
		position: relative;
		max-width: 90vw;
		max-height: 90vh;
		display: flex;
		align-items: center;
		justify-content: center;
		z-index: 1;
		pointer-events: none;
		z-index: 1001;
	}

	&__img {
		//opacity: unset;
		max-width: 100%;
		max-height: 90vh;
		width: auto;
		height: auto;
		object-fit: contain;
		border-radius: $border-radius-sm;
		box-shadow: 0 8px 32px rgba($color-text, 0.5);
		pointer-events: auto;
		cursor: default;
		z-index: 99;
	}

	&__close {
		position: fixed;
		top: 20px;
		right: 20px;
		width: 48px;
		height: 48px;
		display: flex;
		align-items: center;
		justify-content: center;
		background-color: rgba($color-white, 0.9);
		border: none;
		border-radius: 50%;
		cursor: pointer;
		padding: 0;
		z-index: 1001;
		//opacity: 0;
		transition: opacity $transition-base, background-color $transition-base, transform $transition-base;
		color: $color-text;
		pointer-events: auto;

		.is-open & {
			opacity: 1;
		}

		&:hover,
		&:focus-visible {
			background-color: $color-white;
			transform: scale(1.1);
			outline: 2px solid $color-primary;
			outline-offset: 2px;
		}

		&:active {
			transform: scale(0.95);
		}

		svg {
			width: 24px;
			height: 24px;
			pointer-events: none;
		}

		@include mq(sm) {
			top: 16px;
			right: 16px;
			width: 40px;
			height: 40px;

			svg {
				width: 20px;
				height: 20px;
			}
		}
	}
}
